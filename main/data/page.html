<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∞—Ç—á–∏–∫–æ–≤ ESP32</title>
    <link rel="stylesheet" href="/style.css?hash=6423a563">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="icon">üìä</i> –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ESP32</h1>
            <div class="status-container">
                <div class="status" id="status">
                    <span class="status-indicator"></span>
                    <span class="status-text">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
                </div>
                <div class="device-info">
                    <span class="ip-info">IP: 192.168.4.1</span>
                    <span class="time-info" id="currentTime">--:--:--</span>
                </div>
            </div>
        </header>

        <div class="sensors-grid">
            <!-- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ -->
            <div class="sensor-card temperature">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">üå°Ô∏è</i> –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</h3>
                    <div class="sensor-status" id="tempStatus"></div>
                </div>
                <div class="value" id="temperature">--</div>
                <div class="unit">¬∞C</div>
                <div class="sensor-footer">
                    <div class="sensor-range">
                        <span class="range-min">-20</span>
                        <div class="range-bar">
                            <div class="range-fill" id="tempRange"></div>
                        </div>
                        <span class="range-max">60</span>
                    </div>
                </div>
            </div>
            
            <!-- –í–ª–∞–∂–Ω–æ—Å—Ç—å -->
            <div class="sensor-card humidity">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">üíß</i> –í–ª–∞–∂–Ω–æ—Å—Ç—å</h3>
                    <div class="sensor-status" id="humStatus"></div>
                </div>
                <div class="value" id="humidity">--</div>
                <div class="unit">%</div>
                <div class="sensor-footer">
                    <div class="sensor-range">
                        <span class="range-min">0</span>
                        <div class="range-bar">
                            <div class="range-fill" id="humRange"></div>
                        </div>
                        <span class="range-max">100</span>
                    </div>
                </div>
            </div>
            
            <!-- CO‚ÇÇ -->
            <div class="sensor-card co2">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">‚òÅÔ∏è</i> CO‚ÇÇ</h3>
                    <div class="sensor-status" id="co2Status"></div>
                </div>
                <div class="value" id="co2">--</div>
                <div class="unit">ppm</div>
                <div class="sensor-footer">
                    <div class="quality-indicator">
                        <span class="quality-label" id="co2Quality">--</span>
                        <div class="quality-dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sensor-card co">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">üî•</i> CO</h3>
                    <div class="sensor-status" id="coStatus"></div>
                </div>
                <div class="value" id="co">--</div>
                <div class="unit">ppm</div>
                <div class="sensor-footer">
                    <div class="sensor-trend" id="coTrend">
                        <span class="trend-icon">‚Üí</span>
                        <span class="trend-text">–°—Ç–∞–±–∏–ª—å–Ω–æ</span>
                    </div>
                </div>
            </div>
            
            
            <div class="sensor-card lpg">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">‚õΩ</i> LPG</h3>
                    <div class="sensor-status" id="lpgStatus"></div>
                </div>
                <div class="value" id="lpg">--</div>
                <div class="unit">ppm</div>
                <div class="sensor-footer">
                    <div class="alert-indicator" id="lpgAlert">
                        <span class="alert-icon">‚ö†Ô∏è</span>
                        <span class="alert-text">–ù–æ—Ä–º–∞</span>
                    </div>
                </div>
            </div>

            <div class="sensor-card nh3">
                <div class="sensor-header">
                    <h3><i class="sensor-icon">üß™</i> NH‚ÇÉ</h3>
                    <div class="sensor-status" id="nh3Status"></div>
                </div>
                <div class="value" id="nh3">--</div>
                <div class="unit">ppm</div>
                <div class="sensor-footer">
                    <div class="sensor-history">
                        <div class="history-min">min: <span id="nh3Min">--</span></div>
                        <div class="history-max">max: <span id="nh3Max">--</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="charts-container">
            <div class="chart-section">
                <div class="chart-header">
                    <h3><i class="chart-icon">üìà</i> –ò—Å—Ç–æ—Ä–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏</h3>
                    <div class="chart-controls">
                        <select id="timeRange" class="time-select">
                            <option value="10">10 –º–∏–Ω</option>
                            <option value="30" selected>30 –º–∏–Ω</option>
                            <option value="60">1 —á–∞—Å</option>
                            <option value="120">2 —á–∞—Å–∞</option>
                        </select>
                        <button id="exportChart" class="chart-btn" title="–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
                            <span class="btn-icon">üíæ</span>
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="tempHumChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <div class="chart-section">
                <div class="chart-header">
                    <h3><i class="chart-icon">üìâ</i> –£—Ä–æ–≤–Ω–∏ –≥–∞–∑–æ–≤</h3>
                    <div class="chart-controls">
                        <select id="chartType" class="type-select">
                            <option value="line">–õ–∏–Ω–∏—è</option>
                            <option value="bar">–°—Ç–æ–ª–±—Ü—ã</option>
                        </select>
                        <button id="toggleChart" class="chart-btn" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫">
                            <span class="btn-icon">üîÑ</span>
                        </button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="gasChart" width="400" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
        <div class="control-panel">
            <div class="info-section">
                <h4><i class="info-icon">üìã</i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h4>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</span>
                        <span class="info-value" id="lastUpdate">--:--:--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°–ª–µ–¥—É—é—â–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</span>
                        <span class="info-value" id="nextUpdate">5 —Å–µ–∫</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°—Ç–∞—Ç—É—Å DHT22:</span>
                        <span class="info-value" id="dhtStatus">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°—Ç–∞—Ç—É—Å MQ-135:</span>
                        <span class="info-value" id="mqStatus">--</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–í—Å–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:</span>
                        <span class="info-value" id="totalUpdates">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:</span>
                        <span class="info-value" id="uptime">00:00:00</span>
                    </div>
                </div>
            </div>
            
            <div class="control-section">
                <h4><i class="control-icon">üéÆ</i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h4>
                <div class="control-buttons">
                    <button id="refreshBtn" class="control-btn primary">
                        <span class="btn-icon">üîÑ</span>
                        <span class="btn-text">–û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å</span>
                    </button>
                    <button id="pauseBtn" class="control-btn secondary">
                        <span class="btn-icon">‚è∏Ô∏è</span>
                        <span class="btn-text">–ü–∞—É–∑–∞</span>
                    </button>
                    <button id="clearBtn" class="control-btn warning">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">–û—á–∏—Å—Ç–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏</span>
                    </button>
                    <button id="relayBtn" class="control-btn relay">
                        <span class="btn-icon">‚ö°</span>
                        <span class="btn-text">–†–µ–ª–µ: –í–´–ö–õ</span>
                    </button>
                    <!-- –¢–ï–°–¢ –ê–í–ê–†–ò–ò - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–û -->
                    <!--
                    <button id="alarmBtn" class="control-btn danger">
                        <span class="btn-icon">üö®</span>
                        <span class="btn-text">–¢–µ—Å—Ç –∞–≤–∞—Ä–∏–∏</span>
                    </button>
                    -->
                </div>
                
                <div class="settings-section">
                    <h5>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h5>
                    <div class="slider-container">
                        <label for="updateInterval">–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: <span id="intervalValue">5</span> —Å–µ–∫</label>
                        <input type="range" id="updateInterval" min="1" max="30" value="5" class="interval-slider">
                    </div>
                    <div class="checkbox-container">
                        <label class="checkbox-label">
                            <input type="checkbox" id="autoRefresh" checked>
                            <span class="checkmark"></span>
                            –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="showAlerts" checked>
                            <span class="checkmark"></span>
                            –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="soundAlerts">
                            <span class="checkmark"></span>
                            –ó–≤—É–∫–æ–≤—ã–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π -->
        <div class="log-section">
            <div class="log-header">
                <h4><i class="log-icon">üìù</i> –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h4>
                <button id="clearLog" class="log-btn">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
            </div>
            <div class="log-container">
                <div class="log-content" id="eventLog">
                    <div class="log-entry info">
                        <span class="log-time">[--:--:--]</span>
                        <span class="log-message">–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- –§—É—Ç–µ—Ä -->
        <footer>
            <div class="footer-content">
                <div class="footer-left">
                    <div class="system-stats">
                        <span class="stat">–ü–∞–º—è—Ç—å: <span id="memoryUsage">--</span>%</span>
                        <span class="stat">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–π: <span id="connections">1</span></span>
                        <span class="stat">–í–µ—Ä—Å–∏—è: 1.0.0</span>
                    </div>
                </div>
                <div class="footer-center">
                    <div class="connection-quality">
                        <span class="quality-text">–ö–∞—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–∏:</span>
                        <div class="quality-bars">
                            <div class="bar active"></div>
                            <div class="bar active"></div>
                            <div class="bar"></div>
                            <div class="bar"></div>
                        </div>
                    </div>
                </div>
                <div class="footer-right">
                    <div class="footer-links">
                        <a href="#" class="footer-link" onclick="showAbout()">–û —Å–∏—Å—Ç–µ–º–µ</a>
                        <span class="separator">|</span>
                        <a href="#" class="footer-link" onclick="showHelp()">–ü–æ–º–æ—â—å</a>
                        <span class="separator">|</span>
                        <a href="#" class="footer-link" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç</a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                ¬© 2025 –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ESP32 | 
                <span id="pageLoadTime">–ó–∞–≥—Ä—É–∑–∫–∞: -- –º—Å</span>
            </div>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–û —Å–∏—Å—Ç–µ–º–µ" -->
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–û —Å–∏—Å—Ç–µ–º–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</h3>
                <button class="modal-close" onclick="closeModal('aboutModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="about-info">
                    <h4>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
                    <ul>
                        <li><strong>–ú–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:</strong> ESP32</li>
                        <li><strong>–î–∞—Ç—á–∏–∫–∏:</strong> DHT22 (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–≤–ª–∞–∂–Ω–æ—Å—Ç—å), MQ-135 (–≥–∞–∑—ã)</li>
                        <li><strong>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:</strong> –í–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 80</li>
                        <li><strong>–ü—Ä–æ—Ç–æ–∫–æ–ª:</strong> HTTP REST API</li>
                        <li><strong>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:</strong> –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥</li>
                        <li><strong>–ì—Ä–∞—Ñ–∏–∫–∏:</strong> Canvas –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</li> <!-- –ò–∑–º–µ–Ω–∏–ª–∏ –∑–¥–µ—Å—å -->
                    </ul>
                    
                    <h4>–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h4>
                    <ul>
                        <li>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: -40¬∞C –¥–æ 80¬∞C</li>
                        <li>–í–ª–∞–∂–Ω–æ—Å—Ç—å: 0% –¥–æ 100%</li>
                        <li>CO‚ÇÇ: 0-5000 ppm</li>
                        <li>CO: 0-1000 ppm</li>
                        <li>LPG: 0-10000 ppm</li>
                        <li>NH‚ÇÉ: 0-500 ppm</li>
                    </ul>
                    
                    <h4>–ü–æ—Ä–æ–≥–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π</h4>
                    <div class="thresholds">
                        <div class="threshold-item">
                            <span class="threshold-name">CO‚ÇÇ</span>
                            <span class="threshold-value">> 1000 ppm</span>
                            <span class="threshold-level warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</span>
                        </div>
                        <div class="threshold-item">
                            <span class="threshold-name">CO</span>
                            <span class="threshold-value">> 50 ppm</span>
                            <span class="threshold-level danger">–û–ø–∞—Å–Ω–æ—Å—Ç—å</span>
                        </div>
                        <div class="threshold-item">
                            <span class="threshold-name">LPG</span>
                            <span class="threshold-value">> 1000 ppm</span>
                            <span class="threshold-level danger">–í–∑—Ä—ã–≤–æ–æ–ø–∞—Å–Ω–æ</span>
                        </div>  
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" onclick="closeModal('aboutModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notificationArea" class="notification-area"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
    <script src="/script.js?hash=e8260d2e"></script>
    
    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function showAbout() {
            event.preventDefault();
            document.getElementById('aboutModal').style.display = 'flex';
        }
        
        function showHelp() {
            event.preventDefault();
            alert('–ü–æ–º–æ—â—å:\n\n1. –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥\n2. –ù–∞–∂–º–∏—Ç–µ "–ü–∞—É–∑–∞" —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–∞–π–¥–µ—Ä –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞\n4. –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ—Ä–µ–Ω–∏–π\n5. –¶–≤–µ—Ç–∞ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏');
        }
        
        function exportData() {
            event.preventDefault();
            if (window.sensorMonitor && window.sensorMonitor.exportData) {
                window.sensorMonitor.exportData();
            } else {
                alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
            }
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        };
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU');
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        updateCurrentTime();
        setInterval(updateCurrentTime, 1000);
        
        // –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            const loadTime = performance.now();
            const loadTimeElement = document.getElementById('pageLoadTime');
            if (loadTimeElement) {
                loadTimeElement.textContent = `–ó–∞–≥—Ä—É–∑–∫–∞: ${Math.round(loadTime)} –º—Å`;
            }
        });
    </script>
</body>
</html>